# 강원대학교 졸업작품

## 1. 프로젝트명
### cnn을 활용한 졸음운전방지
졸음운전은 주로 밤에 일어납니다. 밤에는 카메라의 졸음운전 검출률이 떨어지기 때문에 cnn(인공지능모델)을 사용하여 개선하면 어떨까 생각하여 진행한 프로젝트 입니다.

## 2. 프로젝트 개요

#### 사용된 하드웨어
    1. 라즈베리파이 
    2. 웹 캠
    3. 보조 배터리
    4. 블루투스 스피커
    5. 위 부품을 담을 수 있는 케이스

#### 사용한 언어
    1. Python

#### 사용 Library
    1. OpenCV 
    2. Dlib 
    3. cnn모델 [dlib face detection- (face landmark)]

#### 프로젝트 설명
    cnn을 사용하지 않은 안구 검출(눈 뜬 상태, 감은 상태)은 빛이 부족해지는 밤에 제대로 동작하지 않습니다.
    운전자한테 라이트를 쏠 수 없으니 적외선 카메라를 사용하거나 검출 방법을 바꾸는게 해결 법중 하나인데,
    저희는 검출 방법을 업그레이드 해보고자 cnn(인공지능 모델)을 사용하였습니다.
    또 하드웨어의 한계로 딥러닝하는 cnn이 아닌 이미 학습된 cnn모델을 사용하였습니다.
    tensorflow도 라즈베리파이에는 CPU의 처리한계와 GPU가 없고 RAM이 모자란 관계로 lite 버전을 사용했습니다.

## 4. 프로그램 동작 순서
    1. 웹캠으로 운전자의 얼굴을 촬영
    2. 촬영된 얼굴을 Python의 라이브러리 OpenCV와 haarcascade학습 데이터를 이용하여 눈 부분만 crop합니다.
    3. crop 한 데이터를 cnn모델로 보내 눈을 뜬 상태면 양수, 감은 상태면 음수를 나타나게 합니다.
    4. 감은 상태가 1초 이상 지속되면 미리 넣어놓은 경고음 파일을 재생시켜 운전자에게 알립니다.


## 5. 결과
    약 30%의 성능 개선이 이뤄젔으며 실제 주행테스트도 해보았지만 Test Case, 표본이 부족하여 성능 개선의 퍼센트가 정확하지 않습니다.

## 6. 개선사항
    하드웨어를 업데이트하여 cloud방식으로 동작하면 좋을 것 같다는 생각이 들었습니다.

    장점으로는 딥러닝하기 위한 데이터를 수집하여 cnn모델을 개선 시킬 수 있고 그로인해 항상 개선된 cnn모델을 사용할 수 있을 것 같습니다.
    
    단점으로는 클라우드 통신할 때에 발생되는 지연시간이 0.1초가 무서운 도로위 시간에서 문제가 생길 수 있을 것 같고 발열을 해소하는 것도 문제입니다.
